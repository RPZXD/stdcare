<?php
// --- Add this block at the top of the file ---
if (!isset($data)) {
    // Load student info if not already set
    include_once("../../config/Database.php");
    include_once("../../class/UserLogin.php");
    $studentDb = new Database("phichaia_student");
    $studentConn = $studentDb->getConnection();
    $user = new UserLogin($studentConn);

    $stuId = $_GET['stuId'] ?? '';
    $term = $_GET['term'] ?? '';
    $pee = $_GET['pee'] ?? '';

    $query = "SELECT * FROM student WHERE Stu_id = :id LIMIT 1";
    $stmt = $studentConn->prepare($query);
    $stmt->bindParam(":id", $stuId);
    $stmt->execute();
    $data = $stmt->fetch(PDO::FETCH_ASSOC);
}
?>

<div class="flex flex-col items-center">
<div class="w-full">
        <div class="bg-blue-100 border-l-4 border-blue-500 p-4 rounded-lg text-center">
            <h5 class="text-xl font-bold">..:: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ::..</h5>
            <hr class="my-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <h6 class="text-base font-medium">
                        üÜî ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: <?= $data['Stu_id']; ?>
                    </h6>
                </div>
                <div>
                    <h6 class="text-base font-medium">
                        üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•: <?= $data['Stu_pre'] . $data['Stu_name'] . " " . $data['Stu_sur']; ?>
                    </h6>
                </div>
                <div>
                    <h6 class="text-base font-medium">
                        üè´ ‡∏ä‡∏±‡πâ‡∏ô: <?= $data['Stu_major'] . "/" . $data['Stu_room']; ?>
                    </h6>
                </div>
                <div>
                    <h6 class="text-base font-medium">
                        üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: <?= $data['Stu_addr']; ?>
                    </h6>
                </div>
                <div>
                    <h6 class="text-base font-medium">
                        üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå: <?= $data['Stu_phone']; ?>
                    </h6>
                </div>
            </div>
        </div>
    </div>

    <div class="w-full mt-6">
        <div class="bg-yellow-100 border-l-4 border-yellow-500 p-6 rounded-lg">
            <form id="addVisitForm" method="post" enctype="multipart/form-data">
                <p class="text-base font-medium mb-4">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>

                <?php
                $questions = [
                    "1. ‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢" => ["‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á", "‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ä‡πà‡∏≤", "‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô"],
                    "2. ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["1-5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£", "6-10 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£", "11-15 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£", "16-20 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£", "20 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ"],
                    "3. ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["‡πÄ‡∏î‡∏¥‡∏ô", "‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô", "‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå", "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß", "‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏£‡∏ñ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "4. ‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏ô" => ["‡∏î‡∏µ", "‡∏û‡∏≠‡πÉ‡∏ä‡πâ", "‡πÑ‡∏°‡πà‡∏î‡∏µ", "‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á"],
                    "5. ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á" => ["‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£", "‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢", "‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", "‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "6. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤" => ["‡πÉ‡∏ô‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô", "‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô", "‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®"],
                    "7. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤" => ["‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô", "‡∏ö‡∏¥‡∏î‡∏≤‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏´‡∏¢‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ô", "‡∏ö‡∏¥‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°", "‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°", "‡∏ö‡∏¥‡∏î‡∏≤‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏£‡∏î‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏Å‡πà‡∏Å‡∏£‡∏£‡∏°"],
                    "8. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏î‡∏π‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Å‡∏ß‡∏î‡∏Ç‡∏±‡∏ô", "‡∏ï‡∏≤‡∏°‡πÉ‡∏à", "‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•", "‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏•‡∏∞‡∏•‡∏∞‡πÄ‡∏•‡∏¢", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "9. ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["‡πÑ‡∏°‡πà‡∏°‡∏µ", "‡∏°‡∏µ"],
                    "10. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß" => ["‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô", "‡πÄ‡∏â‡∏¢‡πÜ", "‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏¥‡∏ô"],
                    "11. ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô" => ["‡∏°‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥", "‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏≤‡∏ß", "‡πÑ‡∏°‡πà‡∏°‡∏µ"],
                    "12. ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ô‡∏¥‡∏ó‡∏™‡∏ô‡∏°‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" => ["‡∏û‡πà‡∏≠", "‡πÅ‡∏°‡πà", "‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß", "‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß", "‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢", "‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "13. ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß" => ["‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠", "‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "‡∏Ç‡∏±‡∏î‡∏™‡∏ô"],
                    "14. ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏î‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏õ‡πá‡∏ô" => ["‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏ô‡∏ô‡πâ‡∏≠‡∏á", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏ô‡∏û‡∏µ‡πà", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏∏‡πà‡∏ô"],
                    "15. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≠", "‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏≤‡∏ä‡∏µ‡∏û", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "16. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏∞‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏Ñ‡∏£" => ["‡∏û‡πà‡∏≠", "‡πÅ‡∏°‡πà", "‡∏û‡∏µ‡πà‡∏™‡∏≤‡∏ß", "‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ß", "‡∏û‡∏µ‡πà‡∏ä‡∏≤‡∏¢", "‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏≤‡∏¢", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"],
                    "17. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏°‡∏≤‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ö‡πâ‡∏≤‡∏ô" => ["‡∏û‡∏≠‡πÉ‡∏à", "‡πÄ‡∏â‡∏¢‡πÜ", "‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à"],
                    "18. ‡∏ó‡∏±‡∏®‡∏ô‡∏Ñ‡∏ï‡∏¥/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" => ["‡∏û‡∏≠‡πÉ‡∏à", "‡πÄ‡∏â‡∏¢‡πÜ", "‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à"],
                ];

                $i = 1;
                foreach ($questions as $question => $options) {
                    echo '<div class="mb-4">';
                    echo '<h5 class="text-base font-bold mb-2">' . $question . '</h5>';
                    echo '<div class="flex flex-wrap gap-4">';
                    foreach ($options as $index => $option) {
                        $radioId = 'vh' . $i . '-' . $index;
                        echo '<div class="flex items-center space-x-2">';
                        echo '<input type="radio" id="' . $radioId . '" name="vh' . $i . '" value="' . ($index + 1) . '" required class="form-radio text-blue-500">';
                        echo '<label for="' . $radioId . '" class="text-base">' . $option . '</label>';
                        echo '</div>';
                    }
                    echo '</div>';
                    echo '</div>';
                    $i++;
                }
                ?>

                <div class="mb-4">
                    <h5 class="text-base font-bold mb-2">20. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤/‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h5>
                    <textarea name="vh20" id="vh20" cols="30" rows="5" class="w-full p-2 border border-gray-300 rounded-lg"></textarea>
                </div>

                <div class="mt-6">
                    <input type="hidden" name="stuId" value="<?= $data['Stu_id'] ?? ''; ?>">
                    <input type="hidden" name="term" value="<?= $term ?? ''; ?>">
                    <input type="hidden" name="pee" value="<?= $pee ?? ''; ?>">
                    
                    <!-- Add submit button -->
                   
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Include SweetAlert for better alerts -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Include the form submission script -->
<script src="../js/visithome.js"></script>
